---
const { slot, format = "auto", style = "" } = Astro.props;
const client = import.meta.env.PUBLIC_ADSENSE_CLIENT || "";

// Map slot names to their corresponding environment variables
const slotEnvMap: Record<string, string> = {
  HEADER: import.meta.env.PUBLIC_ADSENSE_SLOT_HEADER || "",
  SIDEBAR: import.meta.env.PUBLIC_ADSENSE_SLOT_SIDEBAR || "",
  FOOTER: import.meta.env.PUBLIC_ADSENSE_SLOT_FOOTER || "",
  CONTENT: import.meta.env.PUBLIC_ADSENSE_SLOT_CONTENT || "",
  INLINE: import.meta.env.PUBLIC_ADSENSE_SLOT_INLINE || "",
};

const slotId = slotEnvMap[slot.toUpperCase()] || "";
const enabled = Boolean(client && slotId);
---
{enabled ? (
  <ins class="adsbygoogle"
    style={`display:block;${style}`}
    data-ad-client={client}
    data-ad-slot={slotId}
    data-ad-format={format}
    data-full-width-responsive="true"></ins>
) : (
  <div class="ad-placeholder" aria-label="Ad placeholder">
    <small>Ad placeholder ({slot}) â€” will show after AdSense approval.</small>
  </div>
)}
<script is:inline>
  (function() {
    var ads = document.querySelectorAll('.adsbygoogle');
    if (ads.length > 0) {
      (window.adsbygoogle = window.adsbygoogle || []).push({});
    }
  })();
</script>

<style>
  .ad-placeholder{
    border:1px dashed rgba(255,255,255,.18);
    padding:12px;
    border-radius:12px;
    opacity:.85;
    margin: 14px 0;
  }
</style>
